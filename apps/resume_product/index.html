<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Resume Product Router</title>
</head>
<body>
  <pre id="log" style="padding:12px;white-space:pre-wrap;word-break:break-word;background:#111;color:#0f0;border-radius:10px;">
[router] booting...
  </pre>

  <script type="module">
    const logEl = document.getElementById("log");
    const log = (msg, obj) => {
      const line = obj ? (msg + " " + JSON.stringify(obj, null, 2)) : msg;
      logEl.textContent += "\n" + line;
      console.log(line);
    };

    window.addEventListener("error", (e) => log("[error] " + (e?.message || e)));
    window.addEventListener("unhandledrejection", (e) => log("[rejection] " + (e?.reason?.message || e?.reason || e)));

    import { dispatch, getRoute } from "/apps/resume_product/router_runtime.js?v=3";

    // 默认给一个可推进的 route（避免停在 Hub 空白）
    if (!location.hash || location.hash === "#") {
      location.hash = "#/resume";
    }

    const run = () => {
      log("[router] pathname=" + location.pathname + " hash=" + location.hash + " route=" + getRoute());
      const r = dispatch();
      log("[dispatch return]", r);
    };

    window.addEventListener("hashchange", run);
    window.addEventListener("pageshow", run);
    run();
  </script>
  <script type="module" src="/apps/resume_product/app_boot.js?v=3"></script>
</body>
</html>